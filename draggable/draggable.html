<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>Drag & Drop DTO (data transfer object) Example</title>
		<style>
			.wrapper {
				display: flex;
				flex-direction: column;
				gap: 40px;
				margin-top: 20px;
				width: 100%;
			}
			.container {
				display: flex;
				flex-direction: column;
				gap: 8px;
				min-height: 150px;
				padding: 10px;
				border: 2px dashed #bbb;
				border-radius: 6px;
				background: #f9f9f9;
			}
			.item {
				padding: 10px;
				border: 1px solid #999;
				background: #eee;
				cursor: grab;
			}
			.dragging {
				opacity: 0.5;
			}

			.draggingover {
				background: pink;
			}
		</style>
	</head>
	<body>
		<div class="wrapper">
			<div>
				<div class="container" id="container1">
					<div id="mike" class="item" draggable="true" data-container-id="container1">mike</div>
					<div id="jude" class="item" draggable="true" data-container-id="container1">jude</div>
					<div id="scott" class="item" draggable="true" data-container-id="container1">scott</div>
				</div>
			</div>

			<div>
				<div class="container" id="container2">
					<div id="ken" class="item" draggable="true" data-container-id="container2">ken</div>
					<div id="marie" class="item" draggable="true" data-container-id="container2">marie</div>
				</div>
			</div>

			<div>
				<div class="container" id="container3"></div>
			</div>
		</div>

		<script>
			let draggedElement = null;
			let draggedElementId = null;
			let topBottomHalf = null;
			let targetId = null;
			let oldContainerId = null;
			let newContainerId = null;

			// STARTING THE DRAG
			document.addEventListener("dragstart", function (event) {
				draggedElement = event.target;
				draggedElementId = event.target.id;
				oldContainerId = event.target.getAttribute("data-container-id");
				console.log("STARTING THE DRAG...", event.target);
				draggedElement.classList.add("dragging");
			});

			// DRAGGING ENTERING A VALID DROP TARGET
			document.addEventListener("dragenter", function (event) {
				if (event.target.classList.contains("item")) {
					event.target.classList.add("draggingover");
				}
			});

			// DRAGGING OVER A VALID DROP TARGET
			document.addEventListener("dragover", function (event) {
				event.preventDefault();
				console.log("DRAGGING OVER...", event.target.id);

				const rect = event.target.getBoundingClientRect();
				const offset = event.clientY - rect.top;

				if (offset < rect.height / 2) {
					topBottomHalf = "top";
				} else {
					topBottomHalf = "bottom";
				}
			});

			// DRAG LEAVING A VALID DROP TARGET
			document.addEventListener("dragleave", function (event) {
				if (event.target.classList.contains("item")) {
					event.target.classList.remove("draggingover");
				}
			});

			//DRAG DROP - Where You Dropped The Element
			document.addEventListener("drop", function (event) {
				event.preventDefault();

				targetId = event.target.id;
				newContainerId = event.target.getAttribute("data-container-id");
				console.log("xxxxxxxxxxxxx", draggedElementId, topBottomHalf, targetId, oldContainerId, newContainerId);

				event.target.classList.remove("draggingover");
			});

			// ENDED THE DRAGGED ELEMENT - like hitting the esc or dragging over a non valid drop target WHILE dragging
			document.addEventListener("dragend", function (event) {
				console.log("ENDING THE DRAG...", draggedElement);
				draggedElement.classList.remove("dragging");
				console.log("");
				draggedElement = null;
			});
		</script>
	</body>
</html>
